@page "/"
@using BlazorBootstrap

<PageTitle>Plataforma DIGESA - Cannabis Medicinal</PageTitle>

<!-- Dashboard Header -->
<div class="dashboard-header mb-4">
    <div class="row align-items-center">
        <div class="col-md-8">
            <h2 class="fw-bold text-primary mb-1">
                <i class="bi bi-speedometer2 me-2"></i>Panel de Control
            </h2>
            <p class="text-muted mb-0">Bienvenido al sistema de gestión de cannabis medicinal</p>
        </div>
        <div class="col-md-4 text-md-end">
            <div class="d-flex gap-2 justify-content-md-end">
                <button class="btn btn-primary">
                    <i class="bi bi-plus-circle me-1"></i>Nueva Solicitud
                </button>
                <button class="btn btn-outline-secondary">
                    <i class="bi bi-download me-1"></i>Exportar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Estadísticas Principales -->
<div class="row g-4 mb-4">
    <div class="col-xl-3 col-md-6">
        <div class="stats-card bg-primary">
            <div class="stats-card-body">
                <div class="d-flex align-items-center">
                    <div class="stats-icon">
                        <i class="bi bi-people-fill"></i>
                    </div>
                    <div class="stats-content">
                        <div class="stats-number">1,247</div>
                        <div class="stats-label">Pacientes Registrados</div>
                    </div>
                </div>
                <div class="stats-trend">
                    <i class="bi bi-arrow-up"></i> +12% este mes
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-xl-3 col-md-6">
        <div class="stats-card bg-success">
            <div class="stats-card-body">
                <div class="d-flex align-items-center">
                    <div class="stats-icon">
                        <i class="bi bi-file-earmark-check"></i>
                    </div>
                    <div class="stats-content">
                        <div class="stats-number">856</div>
                        <div class="stats-label">Solicitudes Aprobadas</div>
                    </div>
                </div>
                <div class="stats-trend">
                    <i class="bi bi-arrow-up"></i> +8% este mes
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-xl-3 col-md-6">
        <div class="stats-card bg-warning">
            <div class="stats-card-body">
                <div class="d-flex align-items-center">
                    <div class="stats-icon">
                        <i class="bi bi-clock-history"></i>
                    </div>
                    <div class="stats-content">
                        <div class="stats-number">42</div>
                        <div class="stats-label">Pendientes de Revisión</div>
                    </div>
                </div>
                <div class="stats-trend">
                    <i class="bi bi-arrow-down"></i> -15% esta semana
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-xl-3 col-md-6">
        <div class="stats-card bg-info">
            <div class="stats-card-body">
                <div class="d-flex align-items-center">
                    <div class="stats-icon">
                        <i class="bi bi-award"></i>
                    </div>
                    <div class="stats-content">
                        <div class="stats-number">723</div>
                        <div class="stats-label">Certificaciones Emitidas</div>
                    </div>
                </div>
                <div class="stats-trend">
                    <i class="bi bi-arrow-up"></i> +25% este mes
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Gráficos y Actividad Reciente -->
<div class="row g-4 mb-4">
    <!-- Gráfico de Solicitudes -->
    <div class="col-xl-8">
        <div class="dashboard-card">
            <div class="dashboard-card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-graph-up me-2"></i>Solicitudes por Mes
                </h5>
                <div class="dropdown">
                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown">
                        2025
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#">2025</a></li>
                        <li><a class="dropdown-item" href="#">2024</a></li>
                    </ul>
                </div>
            </div>
            <div class="dashboard-card-body">
                <div class="chart-container" style="height: 300px;">
                    <canvas id="solicitudesChart"></canvas>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Actividad Reciente -->
    <div class="col-xl-4">
        <div class="dashboard-card">
            <div class="dashboard-card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-clock me-2"></i>Actividad Reciente
                </h5>
                <a href="#" class="btn btn-sm btn-ghost">Ver todo</a>
            </div>
            <div class="dashboard-card-body p-0">
                <div class="activity-list">
                    <div class="activity-item">
                        <div class="activity-icon bg-primary">
                            <i class="bi bi-person-plus"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">Nuevo paciente registrado</div>
                            <div class="activity-desc">María González - ID: P-2025-001</div>
                            <div class="activity-time">Hace 2 horas</div>
                        </div>
                    </div>
                    
                    <div class="activity-item">
                        <div class="activity-icon bg-success">
                            <i class="bi bi-check-circle"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">Solicitud aprobada</div>
                            <div class="activity-desc">Dr. Carlos Medina aprobó SOL-2025-089</div>
                            <div class="activity-time">Hace 4 horas</div>
                        </div>
                    </div>
                    
                    <div class="activity-item">
                        <div class="activity-icon bg-warning">
                            <i class="bi bi-exclamation-triangle"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">Solicitud requiere revisión</div>
                            <div class="activity-desc">SOL-2025-087 - Documentos incompletos</div>
                            <div class="activity-time">Hace 6 horas</div>
                        </div>
                    </div>
                    
                    <div class="activity-item">
                        <div class="activity-icon bg-info">
                            <i class="bi bi-award"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">Certificación emitida</div>
                            <div class="activity-desc">CERT-2025-156 generada exitosamente</div>
                            <div class="activity-time">Hace 1 día</div>
                        </div>
                    </div>
                    
                    <div class="activity-item">
                        <div class="activity-icon bg-secondary">
                            <i class="bi bi-file-text"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">Reporte mensual generado</div>
                            <div class="activity-desc">Estadísticas de mayo 2025</div>
                            <div class="activity-time">Hace 2 días</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Acciones Rápidas y Estado del Sistema -->
<div class="row g-4 mb-4">
    <!-- Acciones Rápidas -->
    <div class="col-xl-6">
        <div class="dashboard-card">
            <div class="dashboard-card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-lightning me-2"></i>Acciones Rápidas
                </h5>
            </div>
            <div class="dashboard-card-body">
                <div class="row g-3">
                    <div class="col-6">
                        <a href="/pacientes/nuevo" class="quick-action-card text-decoration-none">
                            <div class="quick-action-icon bg-primary">
                                <i class="bi bi-person-plus"></i>
                            </div>
                            <div class="quick-action-text">Registrar Paciente</div>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="/solicitudes" class="quick-action-card text-decoration-none">
                            <div class="quick-action-icon bg-success">
                                <i class="bi bi-file-earmark-plus"></i>
                            </div>
                            <div class="quick-action-text">Ver Solicitudes</div>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="/certificaciones/nueva" class="quick-action-card text-decoration-none">
                            <div class="quick-action-icon bg-warning">
                                <i class="bi bi-award"></i>
                            </div>
                            <div class="quick-action-text">Emitir Certificación</div>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="/reportes" class="quick-action-card text-decoration-none">
                            <div class="quick-action-icon bg-info">
                                <i class="bi bi-graph-up"></i>
                            </div>
                            <div class="quick-action-text">Generar Reporte</div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Estado del Sistema -->
    <div class="col-xl-6">
        <div class="dashboard-card">
            <div class="dashboard-card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-gear me-2"></i>Estado del Sistema
                </h5>
                <span class="badge bg-success">Operativo</span>
            </div>
            <div class="dashboard-card-body">
                <div class="system-status-list">
                    <div class="system-status-item">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="system-status-label">
                                <i class="bi bi-database me-2"></i>Base de Datos
                            </div>
                            <span class="badge bg-success">99.9%</span>
                        </div>
                        <div class="progress mt-2" style="height: 4px;">
                            <div class="progress-bar bg-success" style="width: 99.9%"></div>
                        </div>
                    </div>
                    
                    <div class="system-status-item">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="system-status-label">
                                <i class="bi bi-server me-2"></i>Servidor Web
                            </div>
                            <span class="badge bg-success">98.7%</span>
                        </div>
                        <div class="progress mt-2" style="height: 4px;">
                            <div class="progress-bar bg-success" style="width: 98.7%"></div>
                        </div>
                    </div>
                    
                    <div class="system-status-item">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="system-status-label">
                                <i class="bi bi-shield-check me-2"></i>Seguridad
                            </div>
                            <span class="badge bg-success">100%</span>
                        </div>
                        <div class="progress mt-2" style="height: 4px;">
                            <div class="progress-bar bg-success" style="width: 100%"></div>
                        </div>
                    </div>
                    
                    <div class="system-status-item">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="system-status-label">
                                <i class="bi bi-cloud me-2"></i>Respaldo en Nube
                            </div>
                            <span class="badge bg-warning">95.2%</span>
                        </div>
                        <div class="progress mt-2" style="height: 4px;">
                            <div class="progress-bar bg-warning" style="width: 95.2%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-3 pt-3 border-top">
                    <small class="text-muted">
                        <i class="bi bi-info-circle me-1"></i>
                        Última actualización: Hoy 14:30
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Información Adicional -->
<div class="row g-4">
    <!-- Próximos Vencimientos -->
    <div class="col-xl-4">
        <div class="dashboard-card">
            <div class="dashboard-card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-calendar-event me-2"></i>Próximos Vencimientos
                </h5>
            </div>
            <div class="dashboard-card-body p-0">
                <div class="expiration-list">
                    <div class="expiration-item">
                        <div class="expiration-date">
                            <div class="date-day">15</div>
                            <div class="date-month">JUN</div>
                        </div>
                        <div class="expiration-content">
                            <div class="expiration-title">Certificación CERT-2023-089</div>
                            <div class="expiration-patient">Paciente: Ana Martínez</div>
                        </div>
                        <div class="expiration-status">
                            <span class="badge bg-warning">5 días</span>
                        </div>
                    </div>
                    
                    <div class="expiration-item">
                        <div class="expiration-date">
                            <div class="date-day">22</div>
                            <div class="date-month">JUN</div>
                        </div>
                        <div class="expiration-content">
                            <div class="expiration-title">Certificación CERT-2023-102</div>
                            <div class="expiration-patient">Paciente: Luis Rodríguez</div>
                        </div>
                        <div class="expiration-status">
                            <span class="badge bg-warning">12 días</span>
                        </div>
                    </div>
                    
                    <div class="expiration-item">
                        <div class="expiration-date">
                            <div class="date-day">28</div>
                            <div class="date-month">JUN</div>
                        </div>
                        <div class="expiration-content">
                            <div class="expiration-title">Certificación CERT-2023-156</div>
                            <div class="expiration-patient">Paciente: Carmen López</div>
                        </div>
                        <div class="expiration-status">
                            <span class="badge bg-secondary">18 días</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Distribución por Región -->
    <div class="col-xl-4">
        <div class="dashboard-card">
            <div class="dashboard-card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-geo-alt me-2"></i>Distribución por Región
                </h5>
            </div>
            <div class="dashboard-card-body">
                <div class="region-stats">
                    <div class="region-item">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="region-name">Panamá</span>
                            <span class="region-count">456</span>
                        </div>
                        <div class="progress" style="height: 6px;">
                            <div class="progress-bar bg-primary" style="width: 65%"></div>
                        </div>
                    </div>
                    
                    <div class="region-item">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="region-name">Chiriquí</span>
                            <span class="region-count">198</span>
                        </div>
                        <div class="progress" style="height: 6px;">
                            <div class="progress-bar bg-success" style="width: 28%"></div>
                        </div>
                    </div>
                    
                    <div class="region-item">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="region-name">Coclé</span>
                            <span class="region-count">89</span>
                        </div>
                        <div class="progress" style="height: 6px;">
                            <div class="progress-bar bg-warning" style="width: 12%"></div>
                        </div>
                    </div>
                    
                    <div class="region-item">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="region-name">Veraguas</span>
                            <span class="region-count">67</span>
                        </div>
                        <div class="progress" style="height: 6px;">
                            <div class="progress-bar bg-info" style="width: 9%"></div>
                        </div>
                    </div>
                    
                    <div class="region-item">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="region-name">Otras</span>
                            <span class="region-count">437</span>
                        </div>
                        <div class="progress" style="height: 6px;">
                            <div class="progress-bar bg-secondary" style="width: 18%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Alertas y Notificaciones -->
    <div class="col-xl-4">
        <div class="dashboard-card">
            <div class="dashboard-card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-bell me-2"></i>Alertas y Notificaciones
                </h5>
                <span class="badge bg-danger">3</span>
            </div>
            <div class="dashboard-card-body p-0">
                <div class="alerts-list">
                    <div class="alert-item alert-urgent">
                        <div class="alert-icon">
                            <i class="bi bi-exclamation-triangle"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">Sistema de respaldo</div>
                            <div class="alert-desc">Fallo en respaldo automático</div>
                            <div class="alert-time">Hace 30 min</div>
                        </div>
                    </div>
                    
                    <div class="alert-item alert-warning">
                        <div class="alert-icon">
                            <i class="bi bi-clock"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">Certificaciones por vencer</div>
                            <div class="alert-desc">15 certificaciones vencen esta semana</div>
                            <div class="alert-time">Hace 2 horas</div>
                        </div>
                    </div>
                    
                    <div class="alert-item alert-info">
                        <div class="alert-icon">
                            <i class="bi bi-info-circle"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">Mantenimiento programado</div>
                            <div class="alert-desc">Sistema no disponible el domingo 2-4 AM</div>
                            <div class="alert-time">Hace 1 día</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
